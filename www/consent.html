<h2>consent</h2>
<p>
allow <span id="redirect_uri_label"></span> to access identity <span id="identity_label"></span>?
</p>

<form action="authorize" method="post" id="consent_form">
	<table>
		<tr>
			<td><label for="form_consent_lifetime">grant access for:</label></td>
			<td><select id="form_consent_lifetime" name="consent_lifetime">
				<option value="0">this session</option>
				<option value="3600">one hour</option>
				<option value="86400">one day</option>
				<option value="604800">one week</option>
				<option value="2592000">30 days</option>
				<option value="15552000">180 days</option>
			</select></td>
		</tr>

		<tr>
			<td></td>
			<td><input type="submit" value="allow" name="consented"/>
		</tr>
	</table>

	<input type="hidden" name="client_id" class="prepopulate"/>
	<input type="hidden" name="redirect_uri" class="prepopulate"/>
	<input type="hidden" name="prompt" class="prepopulate"/>
	<input type="hidden" name="nonce" class="prepopulate"/>
	<input type="hidden" name="state" class="prepopulate"/>
	<input type="hidden" name="response_type" class="prepopulate"/>
	<input type="hidden" name="response_mode" class="prepopulate"/>
	<input type="hidden" name="form_key" class="prepopulate"/>
	<input type="hidden" name="max_age" class="prepopulate"/>
	<input type="hidden" name="scope" class="prepopulate"/>
	<input type="hidden" name="req_cnf" class="prepopulate"/>
	<input type="hidden" name="code_challenge" class="prepopulate"/>
	<input type="hidden" name="code_challenge_method" class="prepopulate"/>
</form>

<script language="javascript">
; (function() {
	var params = new URLSearchParams(document.location.hash.substring(1));
	var elements = consent_form.getElementsByClassName("prepopulate");
	for(var i = 0; i < elements.length; i++) {
		var element = elements[i];
		element.value = params.get(element.name);
	}
	redirect_uri_label.innerText = params.get("redirect_uri");
	identity_label.innerText = params.get("identity");
})();
</script>
